<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Select hyperparameters &mdash; PET  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/togglebutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Run model" href="run_model.html" />
    <link rel="prev" title="Train model" href="train_model.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PET
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Train model</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="train_model.html">Train model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Select hyperparameters</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Select hyperparameters</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Run model</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="run_model.html">Run model</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PET</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Select hyperparameters</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/select_hyperparameters.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="select-hyperparameters">
<h1>Select hyperparameters<a class="headerlink" href="#select-hyperparameters" title="Permalink to this heading"></a></h1>
<p>The cutoff radius is the only hyperparameter that must be specified for a particular dataset. The selected cutoff significantly impacts the model. Its accuracy and fitting/inference times are very sensitive to this parameter.</p>
<p>A good starting point is to select a cutoff radius that ensures about 20 neighbors on average. This can be done by analyzing the neighbor lists for different cutoffs before launching the training script. <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/neighborlist.html">This</a> is an example of a neighbor list constructor in Python.</p>
<p>The hyperparameter for the cutoff radius is called “R_CUT”.</p>
<p>The second step involves adjusting the fitting duration of the model. Unlike the specification of a dataset-specific cutoff radius, this step is optional, as reasonable results can already be obtained with the default fitting duration. The time required to fit the model is a complicated function of the model’s size, the size of the dataset, and the complexity of the studied interatomic interactions. The default value might be insufficient for huge datasets. As discussed in the previous section, it’s possible to continue the fitting procedure if the model appears to be underfitted. One can do this by relaunching the fitting script with the same calculation name. However, the total number of epochs is only part of the equation. The other key aspect is the rate at which the learning rate decays. We use <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.StepLR.html">StepLR</a> as a learning rate scheduler. Thus, to increase the overall fitting time, one needs to specify a larger step size which controls how fast StepLR decreases the learning rate. This can be done by specifying the hyperparameter “SCHEDULER_STEP_SIZE”.</p>
<p>For such hyperparameters as “SCHEDULER_STEP_SIZE”, “EPOCH_NUM”, “BATCH_SIZE”, and “EPOCHS_WARMUP”, either normal or atomic versions can be specified. Atomic versions are termed “SCHEDULER_STEP_SIZE_ATOMIC”, “EPOCH_NUM_ATOMIC”, “BATCH_SIZE_ATOMIC”, and “EPOCHS_WARMUP_ATOMIC”. Let’s take batch size, for instance. It makes no sense to use the same batch size for datasets with structures of very different sizes. If one dataset contains, let’s say, molecules with 10 atoms on average and the other nanoparticles with 1000 atoms on average, it makes sense to use a 100 times larger batch size in the first case. If “BATCH_SIZE_ATOMIC” is specified, the normal batch size is computed as BATCH_SIZE = BATCH_SIZE_ATOMIC / (average_number_of_atoms_in_the_training_dataset). A similar logic applies to “SCHEDULER_STEP_SIZE”, “EPOCH_NUM”, and “EPOCHS_WARMUP”. In these cases, normal versions are obtained by division by the total number of atoms of structures in the training dataset. All the default values are given by atomic versions for better transferability.</p>
<p>Thus, in order to increase the step size of the learning rate scheduler by, let’s say, 2 times, one can take the default value for “SCHEDULER_STEP_SIZE_ATOMIC” from the default_hypers/default_hypers.yaml and specify a value that’s twice as large.</p>
<p>To fit the model only on energies, one can specify: “USE_FORCES: False”. Specification for fitting on forces is: “USE_ENERGIES: False”.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="train_model.html" class="btn btn-neutral float-left" title="Train model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="run_model.html" class="btn btn-neutral float-right" title="Run model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>